import t,{useMemo as r,useState as e}from"react";import n from"markdown-to-jsx";import o from"react-mde";import{required as a,useInput as i,Labeled as u,InputHelperText as c,useDataProvider as l,useTranslate as f}from"react-admin";import{makeStyles as s,FormControl as p,FormHelperText as v}from"@material-ui/core";function h(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function y(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?h(Object(e),!0).forEach((function(r){m(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):h(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function d(t,r,e,n,o,a,i){try{var u=t[a](i),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function b(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var a=t.apply(r,e);function i(t){d(a,n,o,i,u,"next",t)}function u(t){d(a,n,o,i,u,"throw",t)}i(void 0)}))}}function m(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function g(){return(g=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}).apply(this,arguments)}function _(t,r){if(null==t)return{};var e,n,o=function(t,r){if(null==t)return{};var e,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)e=a[n],r.indexOf(e)>=0||(o[e]=t[e]);return o}(t,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)e=a[n],r.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(o[e]=t[e])}return o}function O(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var n,o,a=[],i=!0,u=!1;try{for(e=e.call(t);!(i=(n=e.next()).done)&&(a.push(n.value),!r||a.length!==r);i=!0);}catch(t){u=!0,o=t}finally{try{i||null==e.return||e.return()}finally{if(u)throw o}}return a}(t,r)||function(t,r){if(!t)return;if("string"==typeof t)return j(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return j(t,r)}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var w=Array.isArray,P="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},E="object"==typeof P&&P&&P.Object===Object&&P,S="object"==typeof self&&self&&self.Object===Object&&self,x=E||S||Function("return this")(),C=x.Symbol,z=Object.prototype,A=z.hasOwnProperty,k=z.toString,T=C?C.toStringTag:void 0;var $=function(t){var r=A.call(t,T),e=t[T];try{t[T]=void 0;var n=!0}catch(t){}var o=k.call(t);return n&&(r?t[T]=e:delete t[T]),o},F=Object.prototype.toString;var R=function(t){return F.call(t)},I=C?C.toStringTag:void 0;var L=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":I&&I in Object(t)?$(t):R(t)};var D=function(t){return null!=t&&"object"==typeof t};var M=function(t){return"symbol"==typeof t||D(t)&&"[object Symbol]"==L(t)},U=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,q=/^\w*$/;var N=function(t,r){if(w(t))return!1;var e=typeof t;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!M(t))||(q.test(t)||!U.test(t)||null!=r&&t in Object(r))};var W=function(t){var r=typeof t;return null!=t&&("object"==r||"function"==r)};var G,B=function(t){if(!W(t))return!1;var r=L(t);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r},H=x["__core-js_shared__"],J=(G=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"";var K=function(t){return!!J&&J in t},Q=Function.prototype.toString;var V=function(t){if(null!=t){try{return Q.call(t)}catch(t){}try{return t+""}catch(t){}}return""},X=/^\[object .+?Constructor\]$/,Y=Function.prototype,Z=Object.prototype,tt=Y.toString,rt=Z.hasOwnProperty,et=RegExp("^"+tt.call(rt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var nt=function(t){return!(!W(t)||K(t))&&(B(t)?et:X).test(V(t))};var ot=function(t,r){return null==t?void 0:t[r]};var at=function(t,r){var e=ot(t,r);return nt(e)?e:void 0},it=at(Object,"create");var ut=function(){this.__data__=it?it(null):{},this.size=0};var ct=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},lt=Object.prototype.hasOwnProperty;var ft=function(t){var r=this.__data__;if(it){var e=r[t];return"__lodash_hash_undefined__"===e?void 0:e}return lt.call(r,t)?r[t]:void 0},st=Object.prototype.hasOwnProperty;var pt=function(t){var r=this.__data__;return it?void 0!==r[t]:st.call(r,t)};var vt=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=it&&void 0===r?"__lodash_hash_undefined__":r,this};function ht(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}ht.prototype.clear=ut,ht.prototype.delete=ct,ht.prototype.get=ft,ht.prototype.has=pt,ht.prototype.set=vt;var yt=ht;var dt=function(){this.__data__=[],this.size=0};var bt=function(t,r){return t===r||t!=t&&r!=r};var mt=function(t,r){for(var e=t.length;e--;)if(bt(t[e][0],r))return e;return-1},gt=Array.prototype.splice;var _t=function(t){var r=this.__data__,e=mt(r,t);return!(e<0)&&(e==r.length-1?r.pop():gt.call(r,e,1),--this.size,!0)};var Ot=function(t){var r=this.__data__,e=mt(r,t);return e<0?void 0:r[e][1]};var jt=function(t){return mt(this.__data__,t)>-1};var wt=function(t,r){var e=this.__data__,n=mt(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};function Pt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Pt.prototype.clear=dt,Pt.prototype.delete=_t,Pt.prototype.get=Ot,Pt.prototype.has=jt,Pt.prototype.set=wt;var Et=Pt,St=at(x,"Map");var xt=function(){this.size=0,this.__data__={hash:new yt,map:new(St||Et),string:new yt}};var Ct=function(t){var r=typeof t;return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t};var zt=function(t,r){var e=t.__data__;return Ct(r)?e["string"==typeof r?"string":"hash"]:e.map};var At=function(t){var r=zt(this,t).delete(t);return this.size-=r?1:0,r};var kt=function(t){return zt(this,t).get(t)};var Tt=function(t){return zt(this,t).has(t)};var $t=function(t,r){var e=zt(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};function Ft(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Ft.prototype.clear=xt,Ft.prototype.delete=At,Ft.prototype.get=kt,Ft.prototype.has=Tt,Ft.prototype.set=$t;var Rt=Ft;function It(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var e=function(){var n=arguments,o=r?r.apply(this,n):n[0],a=e.cache;if(a.has(o))return a.get(o);var i=t.apply(this,n);return e.cache=a.set(o,i)||a,i};return e.cache=new(It.Cache||Rt),e}It.Cache=Rt;var Lt=It;var Dt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Mt=/\\(\\)?/g,Ut=function(t){var r=Lt(t,(function(t){return 500===e.size&&e.clear(),t})),e=r.cache;return r}((function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(Dt,(function(t,e,n,o){r.push(n?o.replace(Mt,"$1"):e||t)})),r}));var qt=function(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o},Nt=C?C.prototype:void 0,Wt=Nt?Nt.toString:void 0;var Gt=function t(r){if("string"==typeof r)return r;if(w(r))return qt(r,t)+"";if(M(r))return Wt?Wt.call(r):"";var e=r+"";return"0"==e&&1/r==-1/0?"-0":e};var Bt=function(t){return null==t?"":Gt(t)};var Ht=function(t,r){return w(t)?t:N(t,r)?[t]:Ut(Bt(t))};var Jt=function(t){if("string"==typeof t||M(t))return t;var r=t+"";return"0"==r&&1/t==-1/0?"-0":r};var Kt=function(t,r){for(var e=0,n=(r=Ht(r,t)).length;null!=t&&e<n;)t=t[Jt(r[e++])];return e&&e==n?t:void 0};var Qt=function(t,r,e){var n=null==t?void 0:Kt(t,r);return void 0===n?e:n},Vt=["source","record","LabelComponent","overrides"],Xt=function(r){var e=r.source,o=r.record,a=r.LabelComponent,i=r.overrides,u=void 0===i?{}:i,c=_(r,Vt);return o&&Qt(o,e)?t.createElement(n,{options:y({createElement:function(r,e,n){return e.label?t.createElement(t.Fragment,null,t.createElement(a,null,e.label),t.createElement(r,e,n)):t.createElement(r,e,n)},overrides:y({h1:a},u)},c)},Qt(o,e)):null};Xt.defaultProps={LabelComponent:"h2",addLabel:!0};var Yt=s((function(t){return{validationError:{"& .MuiFormLabel-root":{color:t.palette.error.main},"& .mde-text":{outline:"-webkit-focus-ring-color auto 1px",outlineOffset:0,outlineColor:t.palette.error.main,outlineStyle:"auto",outlineWidth:1}}}})),Zt=function(l){var f=Yt(),s=l.validate,h=r((function(){return!!s&&!![].concat(s).find((function(t){return t.toString()===a().toString()}))}),[s]),y=O(e("write"),2),d=y[0],m=y[1],_=i(l),j=_.input,w=j.value,P=j.onChange,E=_.meta,S=E.error,x=E.touched;return t.createElement(p,{fullWidth:!0,className:"ra-input-mde ".concat(S?f.validationError:"")},t.createElement(u,g({},l,{isRequired:h}),t.createElement(o,g({value:w,onChange:function(t){return P(t)},onTabChange:function(t){return m(t)},generateMarkdownPreview:function(){var r=b(regeneratorRuntime.mark((function r(e){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t.createElement(n,null,e));case 1:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}(),selectedTab:d},l))),t.createElement(v,{error:!!S,margin:"dense",variant:"outlined"},t.createElement(c,{error:S,helperText:l.helperText,touched:S||x})))},tr=function(t,r){var e=l(),n=f();return function(){var o=b(regeneratorRuntime.mark((function o(a){var i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!a){o.next=9;break}return o.next=3,e.getList(t,{pagination:{page:1,perPage:5},filter:{q:a}});case 3:if(!((i=o.sent).total>0)){o.next=8;break}return o.abrupt("return",i.data.map((function(e){return{preview:e[r],value:"[".concat(e[r],"](/").concat(t,"/").concat(encodeURIComponent(e.id),"/show)")}})));case 8:return o.abrupt("return",[{preview:n("ra.navigation.no_results"),value:"["+a}]);case 9:return o.abrupt("return",[{preview:n("ra.action.search"),value:"["+a}]);case 10:case"end":return o.stop()}}),o)})));return function(t){return o.apply(this,arguments)}}()};export{Xt as MarkdownField,Zt as MarkdownInput,tr as useLoadLinks};
//# sourceMappingURL=index.es.js.map
