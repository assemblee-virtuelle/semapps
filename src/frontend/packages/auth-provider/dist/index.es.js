import*as e from"react";import t,{useState as r,useEffect as n,useCallback as a,useMemo as o,forwardRef as i}from"react";import{useTranslate as s,useGetList as c,useDataProvider as u,Loading as l,Error as d,usePermissionsOptimized as m,useAuthProvider as p,Button as f,ListButton as h,ShowButton as g,useRecordContext as v,DeleteButton as b,Toolbar as y,SaveButton as w,useGetIdentity as _,useNotify as E,useRedirect as j,Edit as x,EditButton as k,Show as P,useLogin as O,Notification as C,useSafeSetState as S,LoginForm as A,useLogout as R,Resource as I,UserMenu as T,MenuItemLink as N,useGetPermissions as U}from"react-admin";import{TopToolbar as L,List as z,ListActions as W}from"@semapps/archipelago-layout";import D from"@material-ui/icons/Share";import{useCreateContainer as V}from"@semapps/semantic-data-provider";import{makeStyles as Y,TextField as B,List as F,ListItem as M,ListItemAvatar as $,Avatar as q,ListItemText as H,ListItemSecondaryAction as G,IconButton as J,Menu as K,MenuItem as Q,ListItemIcon as X,Dialog as Z,DialogTitle as ee,DialogContent as te,DialogActions as re,Card as ne,Typography as ae,CardActions as oe,Button as ie,CircularProgress as se,createTheme as ce,ThemeProvider as ue}from"@material-ui/core";import le from"@material-ui/lab/Autocomplete";import de from"@material-ui/icons/Person";import me from"@material-ui/icons/Edit";import pe from"@material-ui/icons/Check";import fe from"@material-ui/icons/Public";import he from"@material-ui/icons/VpnLock";import ge from"@material-ui/icons/Group";import{useLocation as ve,Redirect as be,Link as ye}from"react-router-dom";import{ThemeProvider as we}from"@material-ui/styles";import{makeStyles as _e,createTheme as Ee}from"@material-ui/core/styles";import je from"@material-ui/icons/Lock";import{Form as xe,Field as ke}from"react-final-form";import Pe from"@material-ui/icons/PowerSettingsNew";import Oe from"@material-ui/icons/AccountCircle";function Ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ae(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function Re(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ae(o,n,a,i,s,"next",e)}function s(e){Ae(o,n,a,i,s,"throw",e)}i(void 0)}))}}function Ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Te(){return(Te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ne(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}(e,t)||ze(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e){return function(e){if(Array.isArray(e))return We(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ze(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){if(e){if("string"==typeof e)return We(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?We(e,t):void 0}}function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function De(e){this.message=e}De.prototype=new Error,De.prototype.name="InvalidCharacterError";var Ve="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new De("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,a=0,o=0,i="";n=t.charAt(o++);~n&&(r=a%4?64*r+n:n,a++%4)?i+=String.fromCharCode(255&r>>(-2*a&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i};function Ye(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(Ve(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return Ve(t)}}function Be(e){this.message=e}function Fe(e,t){if("string"!=typeof e)throw new Be("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(Ye(e.split(".")[r]))}catch(e){throw new Be("Invalid token specified: "+e.message)}}Be.prototype=new Error,Be.prototype.name="InvalidTokenError";var Me="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function $e(e,t){return e(t={exports:{}},t.exports),t.exports}var qe,He,Ge=$e((function(e){var t,r;t=Me,r=function(){function e(e){var t=[];if(0===e.length)return"";if("string"!=typeof e[0])throw new TypeError("Url must be a string. Received "+e[0]);if(e[0].match(/^[^/:]+:\/*$/)&&e.length>1){var r=e.shift();e[0]=r+e[0]}e[0].match(/^file:\/\/\//)?e[0]=e[0].replace(/^([^/:]+):\/*/,"$1:///"):e[0]=e[0].replace(/^([^/:]+):\/*/,"$1://");for(var n=0;n<e.length;n++){var a=e[n];if("string"!=typeof a)throw new TypeError("Url must be a string. Received "+a);""!==a&&(n>0&&(a=a.replace(/^[\/]+/,"")),a=n<e.length-1?a.replace(/[\/]+$/,""):a.replace(/[\/]+$/,"/"),t.push(a))}var o=t.join("/"),i=(o=o.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return o=i.shift()+(i.length>0?"?":"")+i.join("&")}return function(){return e("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}},e.exports?e.exports=r():t.urljoin=r()})),Je=function(e){return e?Array.isArray(e)?e:[e]:void 0},Ke=function(e){var t=new URL(e);return Ge(t.origin,"_acl",t.pathname)},Qe=function(e){return{"@base":e,acl:"http://www.w3.org/ns/auth/acl#",foaf:"http://xmlns.com/foaf/0.1/","acl:agent":{"@type":"@id"},"acl:agentGroup":{"@type":"@id"},"acl:agentClass":{"@type":"@id"},"acl:mode":{"@type":"@id"},"acl:accessTo":{"@type":"@id"}}},Xe=["username","email","password","domain"],Ze=function(e){var t,r,n,a,o,i,s,c,u,l,d,m,p=e.middlewareUri,f=e.allowAnonymous,h=void 0===f||f,g=e.localAccounts,v=void 0!==g&&g,b=e.checkUser,y=e.httpClient,w=e.checkPermissions;return{login:(m=Re(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new URL(window.location.href),n=p||t.domain&&"https://".concat(t.domain,"/")){e.next=4;break}throw new Error("You must specify a middlewareUri in the authProvider config, or specify a domain when calling the login method");case 4:if(!v){e.next=21;break}return a=t.username,o=t.password,e.prev=6,e.next=9,y("".concat(n,"auth/login"),{method:"POST",body:JSON.stringify({username:a.trim(),password:o.trim()}),headers:new Headers({"Content-Type":"application/json"})});case 9:i=e.sent,s=i.json,c=s.token,localStorage.setItem("token",c),window.location.reload(),e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(6),new Error("ra.auth.sign_in_error");case 19:e.next=22;break;case 21:window.location.href="".concat(n,"auth?redirectUrl=")+encodeURIComponent(r.origin+"/login?login=true");case 22:case"end":return e.stop()}}),e,null,[[6,16]])}))),function(e){return m.apply(this,arguments)}),signup:(d=Re(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,s,c,u,l,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p||t.domain&&"https://".concat(t.domain,"/")){e.next=3;break}throw new Error("You must specify a middlewareUri in the authProvider config, or specify a domain when calling the signup method");case 3:if(!v){e.next=33;break}return n=t.username,a=t.email,o=t.password,i=t.domain,s=Ne(t,Xe),e.prev=5,e.next=8,y("".concat(r||"https://".concat(i),"auth/signup"),{method:"POST",body:JSON.stringify(Se({username:n.trim(),email:a.trim(),password:o.trim()},s)),headers:new Headers({"Content-Type":"application/json"})});case 8:return c=e.sent,u=c.json,l=u.token,localStorage.setItem("token",l),d=Fe(l),m=d.webId,e.abrupt("return",m);case 16:if(e.prev=16,e.t0=e.catch(5),"email.already.exists"!==e.t0.message){e.next=22;break}throw new Error("auth.message.user_email_exist");case 22:if("username.already.exists"!==e.t0.message){e.next=26;break}throw new Error("auth.message.username_exist");case 26:if("username.invalid"!==e.t0.message){e.next=30;break}throw new Error("auth.message.username_invalid");case 30:throw new Error(e.t0.message||"ra.auth.sign_in_error");case 31:e.next=34;break;case 33:window.location.href="".concat(r,"auth?redirectUrl=")+encodeURIComponent(url.origin+"/login?login=true");case 34:case"end":return e.stop()}}),e,null,[[5,16]])}))),function(e){return d.apply(this,arguments)}),logout:(l=Re(regeneratorRuntime.mark((function e(){var t,r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p?t=p:(r=localStorage.getItem("token"))&&(n=Fe(r),a=n.webId,t=new URL(a).origin+"/"),localStorage.removeItem("token"),v?(window.location.reload(),window.location.href="/"):t&&(o=new URL(window.location.href),window.location.href=h?"".concat(t,"auth/logout?redirectUrl=")+encodeURIComponent(o.origin+"/login?logout=true"):"".concat(t,"auth/logout?redirectUrl=")+encodeURIComponent(o.origin+"/login")),e.abrupt("return","/");case 4:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)}),checkAuth:(u=Re(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("token")||h){e.next=3;break}throw new Error;case 3:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)}),checkUser:function(e){return!b||b(e)},checkError:function(e){return Promise.resolve()},getPermissions:(c=Re(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.startsWith(p)){e.next=2;break}return e.abrupt("return",!1);case 2:if(w){e.next=4;break}return e.abrupt("return",!0);case 4:if(t&&t.startsWith("http")){e.next=6;break}throw new Error("The first parameter passed to getPermissions must be an URL");case 6:return r=Ke(t),e.next=9,y(r);case 9:return n=e.sent,a=n.json,e.abrupt("return",a["@graph"]);case 12:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)}),addPermission:(s=Re(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.startsWith("http")){e.next=2;break}throw new Error("The first parameter passed to addPermission must be an URL");case 2:return t.startsWith(p),i=Ke(t),Ie(o={"@id":"#"+a.replace("acl:",""),"@type":"acl:Authorization"},n,r),Ie(o,"acl:accessTo",t),Ie(o,"acl:mode",a),s=o,e.next=7,y(i,{method:"PATCH",body:JSON.stringify({"@context":Qe(i),"@graph":[s]})});case 7:case"end":return e.stop()}}),e)}))),function(e,t,r,n){return s.apply(this,arguments)}),removePermission:(i=Re(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.startsWith("http")){e.next=2;break}throw new Error("The first parameter passed to removePermission must be an URL");case 2:if(t.startsWith(p)){e.next=4;break}throw new Error("Cannot remove permissions on servers other than the one used for auth");case 4:return o=Ke(t),e.next=7,y(o);case 7:return i=e.sent,s=i.json,c=s["@graph"].filter((function(e){return!e["@id"].includes("#Default")})).map((function(e){var t=Je(e["acl:mode"]),o=Je(e[n]);return a&&t.includes(a)&&o&&o.includes(r)&&(o=o.filter((function(e){return e!==r}))),Se(Se({},e),{},Ie({},n,o))})),e.next=12,y(o,{method:"PUT",body:JSON.stringify({"@context":Qe(o),"@graph":c})});case 12:case"end":return e.stop()}}),e)}))),function(e,t,r,n){return i.apply(this,arguments)}),getIdentity:(o=Re(regeneratorRuntime.mark((function e(){var t,r,n,a,o,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("token"))){e.next=17;break}return r=Fe(t),n=r.webId,e.next=5,y(n);case 5:if(a=e.sent,!(o=a.json).url){e.next=13;break}return e.next=10,y(o.url);case 10:e.t0=e.sent,e.next=14;break;case 13:e.t0={};case 14:return i=e.t0,s=i.json,e.abrupt("return",{id:n,fullName:(null==s?void 0:s["vcard:given-name"])||(null==s?void 0:s["pair:label"])||o["foaf:name"],profileData:s,webIdData:o});case 17:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),resetPassword:(a=Re(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p||t.domain&&"https://".concat(t.domain,"/")){e.next=3;break}throw new Error("You must specify a middlewareUri in the authProvider config, or specify a domain when calling the forgot password method");case 3:return n=t.email,e.prev=4,e.next=7,y("".concat(r,"auth/reset_password"),{method:"POST",body:JSON.stringify({email:n.trim()}),headers:new Headers({"Content-Type":"application/json"})});case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),new Error("app.notification.reset_password_error");case 12:case"end":return e.stop()}}),e,null,[[4,9]])}))),function(e){return a.apply(this,arguments)}),setNewPassword:(n=Re(regeneratorRuntime.mark((function e(t){var r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p||t.domain&&"https://".concat(t.domain,"/")){e.next=3;break}throw new Error("You must specify a middlewareUri in the authProvider config, or specify a domain when calling the new password method");case 3:return n=t.email,a=t.token,o=t.password,e.prev=4,e.next=7,y("".concat(r,"auth/new_password"),{method:"POST",body:JSON.stringify({email:n.trim(),token:a,password:o}),headers:new Headers({"Content-Type":"application/json"})});case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),new Error("app.notification.new_password_error");case 12:case"end":return e.stop()}}),e,null,[[4,9]])}))),function(e){return n.apply(this,arguments)}),getAccountSettings:(r=Re(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p||t.domain&&"https://".concat(t.domain,"/")){e.next=3;break}throw new Error("You must specify a middlewareUri in the authProvider config, or specify a domain when calling the getAccountSettings method");case 3:return e.prev=3,e.next=6,y("".concat(r,"auth/account"),{method:"GET"});case 6:return n=e.sent,a=n.json,e.abrupt("return",a);case 11:throw e.prev=11,e.t0=e.catch(3),new Error("app.notification.get_settings_error");case 14:case"end":return e.stop()}}),e,null,[[3,11]])}))),function(e){return r.apply(this,arguments)}),updateAccountSettings:(t=Re(regeneratorRuntime.mark((function e(t){var r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p||t.domain&&"https://".concat(t.domain,"/")){e.next=3;break}throw new Error("You must specify a middlewareUri in the authProvider config, or specify a domain when calling the updateAccountSettings method");case 3:return e.prev=3,n=t.email,a=t.currentPassword,o=t.newPassword,e.next=7,y("".concat(r,"auth/account"),{method:"POST",body:JSON.stringify({currentPassword:a,email:n.trim(),newPassword:o}),headers:new Headers({"Content-Type":"application/json"})});case 7:e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(3),"auth.account.invalid_password"!==e.t0.message){e.next=13;break}throw new Error("app.notification.invalid_password");case 13:throw new Error("app.notification.update_settings_error");case 14:case"end":return e.stop()}}),e,null,[[3,9]])}))),function(e){return t.apply(this,arguments)})}},et="acl:agentClass",tt=["acl:Append","acl:Write","acl:Control"],rt=["acl:Append","acl:Write","acl:Control"],nt=["acl:Write","acl:Control"],at=["acl:Control"],ot={show:["acl:Read","acl:Append","acl:Write","acl:Control"],list:["acl:Read","acl:Append","acl:Write","acl:Control"],create:tt,edit:rt,delete:nt,control:at},it={show:"auth.message.resource_show_forbidden",edit:"auth.message.resource_edit_forbidden",delete:"auth.message.resource_delete_forbidden",control:"auth.message.resource_control_forbidden",list:"auth.message.container_list_forbidden",create:"auth.message.container_create_forbidden"},st=(Ie(qe={},"acl:Read","auth.right.resource.read"),Ie(qe,"acl:Append","auth.right.resource.append"),Ie(qe,"acl:Write","auth.right.resource.write"),Ie(qe,"acl:Control","auth.right.resource.control"),qe),ct=(Ie(He={},"acl:Read","auth.right.container.read"),Ie(He,"acl:Write","auth.right.container.write"),Ie(He,"acl:Control","auth.right.container.control"),He),ut=Y((function(){return{list:{padding:0,width:"100%"},option:{padding:0}}})),lt=function(e){var a=e.agents,o=e.addPermission,i=ut(),u=s(),l=Ue(r(null),2),d=l[0],m=l[1],p=Ue(r(""),2),f=p[0],h=p[1],g=Ue(r([]),2),v=g[0],b=g[1],y=c("Person",{page:1,perPage:100},{field:"pair:label",order:"ASC"},{q:f},{enabled:f.length>0}),w=y.ids,_=y.data;return n((function(){b(w.length>0?Object.values(_):[])}),[w,_]),t.createElement(le,{classes:{option:i.option},getOptionLabel:function(e){return e["pair:label"]},filterOptions:function(e){return e.filter((function(e){return!Object.keys(a).includes(e.id)}))},options:v,noOptionsText:u("ra.navigation.no_results"),autoComplete:!0,blurOnSelect:!0,clearOnBlur:!0,disableClearable:!0,value:d,onChange:function(e,t){o(t.id||t["@id"],"acl:agent","acl:Read"),m(null),h(""),b([])},onInputChange:function(e,t){h(t)},renderInput:function(e){return t.createElement(B,Te({},e,{label:u("auth.input.agent_select"),variant:"filled",margin:"dense",fullWidth:!0}))},renderOption:function(e){return t.createElement(F,{dense:!0,className:i.list},t.createElement(M,{button:!0},t.createElement($,null,t.createElement(q,{src:e.image},t.createElement(de,null))),t.createElement(H,{primary:e["pair:label"]})))}})},dt=function(e){var r=e.agent;switch(r.predicate){case et:return"foaf:Agent"===r.id?t.createElement(fe,null):t.createElement(he,null);case"acl:agent":return t.createElement(de,null);case"acl:agentGroup":return t.createElement(ge,null);default:throw new Error("Unknown agent predicate: "+r.predicate)}},mt=Y((function(){return{listItem:{paddingLeft:4,paddingRight:36},primaryText:{width:"30%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},secondaryText:{textAlign:"center",width:"60%",fontStyle:"italic",color:"grey"}}})),pt=function(e){var a=e.isContainer,o=e.agent,i=e.addPermission,c=e.removePermission,m=mt(),p=s(),f=u(),h=Ue(t.useState(null),2),g=h[0],v=h[1],b=Ue(r(),2),y=b[0],w=b[1],_=Ue(r(!0),2),E=_[0],j=_[1],x=Ue(r(),2),k=x[0],P=x[1];if(n((function(){"acl:agent"===o.predicate?f.getOne("Person",{id:o.id}).then((function(e){var t=e.data;w(t),j(!1)})).catch((function(e){P(e),j(!1)})):j(!1)}),[o.id,o.predicate]),"acl:agentGroup"===o.predicate)return null;var O=function(){return v(null)},C=a?ct:st;return E?t.createElement(l,null):k?t.createElement(d,null):t.createElement(M,{className:m.listItem},t.createElement($,null,t.createElement(q,{src:null==y?void 0:y.image},t.createElement(dt,{agent:o}))),t.createElement(H,{className:m.primaryText,primary:y?y["pair:label"]:p("foaf:Agent"===o.id?"auth.agent.anonymous":"auth.agent.authenticated")}),t.createElement(H,{className:m.secondaryText,primary:o.permissions&&o.permissions.map((function(e){return p(C[e])})).join(", ")}),t.createElement(G,null,t.createElement(J,{onClick:function(e){return v(e.currentTarget)}},t.createElement(me,null)),t.createElement(K,{anchorEl:g,keepMounted:!0,open:Boolean(g),onClose:O},Object.entries(C).map((function(e){var r=Ue(e,2),n=r[0],a=r[1],s=o.permissions&&o.permissions.includes(n);return t.createElement(Q,{key:n,onClick:function(){s?c(o.id,o.predicate,n):i(o.id,o.predicate,n),O()}},t.createElement(X,null,s?t.createElement(pe,null):null),t.createElement(H,{primary:p(a)}))})))))},ft=Y((function(e){return{list:{width:"100%",maxWidth:"100%",backgroundColor:e.palette.background.paper}}})),ht=function(e){var r=e.isContainer,n=e.agents,a=e.addPermission,o=e.removePermission,i=ft();return t.createElement(F,{dense:!0,className:i.list},Object.entries(n).map((function(e){var n=Ue(e,2),i=n[0],s=n[1];return t.createElement(pt,{key:i,isContainer:r,agent:s,addPermission:a,removePermission:o})})))},gt=function(e){var t=m(e).permissions,o=p(),i=Ue(r({}),2),s=i[0],c=i[1];n((function(){var e,r=(Ie(e={},"foaf:Agent",{id:"foaf:Agent",predicate:et,permissions:[]}),Ie(e,"acl:AuthenticatedAgent",{id:"acl:AuthenticatedAgent",predicate:et,permissions:[]}),e),n=function(e,t,n){r[e]?r[e].permissions.push(n):r[e]={id:e,predicate:t,permissions:[n]}};if(t){var a,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ze(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}(t);try{var i=function(){var e=a.value;e[et]&&Je(e[et]).forEach((function(t){return n(t,et,e["acl:mode"])})),e["acl:agent"]&&Je(e["acl:agent"]).forEach((function(t){return n(t,"acl:agent",e["acl:mode"])})),e["acl:agentGroup"]&&Je(e["acl:agentGroup"]).forEach((function(t){return n(t,"acl:agentGroup",e["acl:mode"])}))};for(o.s();!(a=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}c(r)}}),[t]);var u=a((function(t,r,n){var a,i=Se({},s);c(Se(Se({},s),{},Ie({},t,{id:t,predicate:r,permissions:s[t]?[].concat(Le(null===(a=s[t])||void 0===a?void 0:a.permissions),[n]):[n]}))),o.addPermission(e,t,r,n).catch((function(e){c(i)}))}),[s,c,e,o]),l=a((function(t,r,n){var a=Se({},s);c(Object.fromEntries(Object.entries(s).map((function(e){var r=Ue(e,2),a=r[0],o=r[1];return o.id===t&&(o.permissions=o.permissions.filter((function(e){return e!==n}))),[a,o]})).filter((function(e){var t=Ue(e,2);t[0];var r=t[1];return r.predicate===et||r.permissions.length>0})))),o.removePermission(e,t,r,n).catch((function(e){c(a)}))}),[s,c,e,o]);return{agents:s,addPermission:u,removePermission:l}},vt=Y((function(){return{title:{paddingBottom:8},actions:{padding:15},addForm:{paddingTop:0},listForm:{paddingTop:0,paddingBottom:0,paddingRight:0,maxHeight:210}}})),bt=function(e){var r=e.open,n=e.onClose,a=e.uri,o=e.isContainer,i=vt(),c=s(),u=gt(a),l=u.agents,d=u.addPermission,m=u.removePermission;return t.createElement(Z,{fullWidth:!0,open:r,onClose:n},t.createElement(ee,{className:i.title},c(o?"auth.dialog.container_permissions":"auth.dialog.resource_permissions")),t.createElement(te,{className:i.addForm},t.createElement(lt,{agents:l,addPermission:d})),t.createElement(te,{className:i.listForm},t.createElement(ht,{isContainer:o,agents:l,addPermission:d,removePermission:m})),t.createElement(re,{className:i.actions},t.createElement(f,{label:"ra.action.close",variant:"text",onClick:n})))},yt=function(e){var n=e.record,a=e.resource,o=Ue(r(!1),2),i=o[0],s=o[1],c=V(a),u=!!a,l=u?c:n.id||n["@id"];return t.createElement(t.Fragment,null,t.createElement(f,{label:"auth.action.permissions",onClick:function(){return s(!0)}},t.createElement(D,null)),t.createElement(bt,{uri:l,isContainer:!!u,open:i,onClose:function(){return s(!1)}}))},wt=["basePath","className","data","hasList","hasShow","hasControl"],_t=function(e){var r=e.basePath,n=e.className,a=e.data,o=e.hasList,i=e.hasShow,s=e.hasControl,c=Ne(e,wt);return t.createElement(L,Te({className:n},c),o&&t.createElement(h,{basePath:r,record:a}),i&&t.createElement(g,{basePath:r,record:a}),a&&s&&t.createElement(yt,{basePath:r,record:a}))},Et=function(e){var r=v(),n=m(r.id).permissions;return n&&n.some((function(e){return nt.includes(e["acl:mode"])}))?t.createElement(b,e):null},jt=Y((function(){return{toolbar:{flex:1,display:"flex",justifyContent:"space-between"}}})),xt=function(e){var r=jt();return t.createElement(y,Te({},e,{className:r.toolbar}),t.createElement(w,null),t.createElement(Et,{undoable:!1}),"}")},kt=function(){var e=_(),t=e.identity,r=e.loading,a=E(),o=j(),i=ve();return n((function(){r||null!=t&&t.id||(a("ra.auth.auth_check_error","error"),o("/login?redirect="+encodeURIComponent(i.pathname+i.search)))}),[r,t,o,a,i]),{identity:t,loading:r}},Pt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",a=_(),o=a.identity,i=a.loading,s=m(e),c=s.permissions,u=E(),l=j();return n((function(){!i&&o&&c&&!c.some((function(e){return ot[t].includes(e["acl:mode"])}))&&(u(it[t],"error"),l(r))}),[c,o,l,u,i]),c},Ot=function(e){var r=Pt(e.id,"edit");return t.createElement(x,Te({actions:t.createElement(_t,{hasControl:!!r&&r.some((function(e){return at.includes(e["acl:mode"])}))})},e,{permissions:r}),t.cloneElement(e.children,Se({toolbar:t.createElement(xt,null)},e.children.props)))},Ct=["actions","resource","hasCreate"],St=function(e){var r=e.actions,n=e.resource,a=e.hasCreate,o=Ne(e,Ct),i=V(n),s=m(i).permissions;return t.createElement(z,Te({},o,{resource:n,hasCreate:a&&!!s&&s.some((function(e){return tt.includes(e["acl:mode"])})),actions:r&&s&&s.some((function(e){return at.includes(e["acl:mode"])}))?t.cloneElement(r,{bulkActions:t.createElement(yt,null)}):r}))};St.defaultProps={actions:t.createElement(W,null)};var At=["basePath","className","data","hasList","hasEdit","hasControl"],Rt=function(e){var r=e.basePath,n=e.className,a=e.data,o=e.hasList,i=e.hasEdit,s=e.hasControl,c=Ne(e,At);return t.createElement(L,Te({className:n},c),o&&t.createElement(h,{basePath:r,record:a}),i&&t.createElement(k,{basePath:r,record:a}),a&&s&&t.createElement(yt,{basePath:r,record:a}))},It=function(e){var r=m(e.id).permissions;return t.createElement(P,Te({actions:t.createElement(Rt,{hasControl:!!r&&r.some((function(e){return at.includes(e["acl:mode"])}))})},e,{permissions:r,hasEdit:e.hasEdit&&!!r&&r.some((function(e){return rt.includes(e["acl:mode"])}))}))},Tt=_e((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",alignItems:"center",justifyContent:"flex-start",backgroundColor:e.palette.grey[300]},text:{maxWidth:300,textAlign:"center",padding:"4px 8px 8px"},card:{minWidth:300,marginTop:"6em"},lockIconAvatar:{margin:"1em",display:"flex",justifyContent:"center"},lockIcon:{backgroundColor:e.palette.grey[500]}}})),Nt=function(e){var r=e.theme,a=e.history,o=e.location,i=e.buttons,s=e.userResource,c=e.text,l=Tt(),d=E(),m=O(),f=u(),h=p();return n((function(){Re(regeneratorRuntime.mark((function e(){var t,r,n,i,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=new URLSearchParams(o.search)).has("login")){e.next=14;break}if(!t.has("error")){e.next=6;break}"registration.not-allowed"===t.get("error")?d("auth.message.user_email_not_found","error"):d("auth.message.bad_request","error",{error:t.get("error")}),e.next=14;break;case 6:if(!t.has("token")){e.next=14;break}return r=t.get("token"),n=Fe(r),i=n.webId,e.next=11,f.getOne(s,{id:i});case 11:c=e.sent,u=c.data,h.checkUser(u)?(localStorage.setItem("token",r),t.has("new")&&"true"===t.get("new")?(d("auth.message.new_user_created","info"),a.push("/"+s+"/"+encodeURIComponent(i)+"/edit")):(d("auth.message.user_connected","info"),a.push("/"))):(d("auth.message.user_not_allowed_to_login","error"),a.replace("/login"));case 14:t.has("logout")&&(localStorage.removeItem("token"),d("auth.message.user_disconnected","info"),a.push("/"));case 15:case"end":return e.stop()}}),e)})))()}),[o.search]),t.createElement(we,{theme:Ee(r)},t.createElement("div",{className:l.main},t.createElement(ne,{className:l.card},t.createElement("div",{className:l.lockIconAvatar},t.createElement(q,{className:l.lockIcon},t.createElement(je,null))),c&&t.createElement(ae,{variant:"body2",className:l.text},c),i&&i.map((function(e,r){return t.createElement(oe,{key:r},t.cloneElement(e,{fullWidth:!0,variant:"outlined",type:"submit",onClick:function(){return m({},"/login")}}))})))),t.createElement(C,null))};Nt.defaultProps={buttons:[t.createElement(ie,{startIcon:t.createElement(q,{src:"/lescommuns.jpg"})},"Les Communs")],userResource:"Person"};var Ut=_e((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",alignItems:"center",justifyContent:"flex-start",backgroundColor:e.palette.grey[300]},text:{maxWidth:300,textAlign:"center",padding:"4px 8px 8px"},card:{minWidth:300,marginTop:"6em"},lockIconAvatar:{margin:"1em",display:"flex",justifyContent:"center"},lockIcon:{backgroundColor:e.palette.grey[500]}}})),Lt=function(e){var r=e.theme,a=e.history,o=e.location,i=e.podProviders,s=e.userResource,c=e.text,u=Ut(),l=E(),d=p();return n((function(){Re(regeneratorRuntime.mark((function e(){var t,r,n,i,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=new URLSearchParams(o.search)).has("login")){e.next=17;break}if(!t.has("error")){e.next=6;break}"registration.not-allowed"===t.get("error")?l("auth.message.user_email_not_found","error"):l("auth.message.bad_request","error",{error:t.get("error")}),e.next=17;break;case 6:if(!t.has("token")){e.next=17;break}return r=t.get("token"),n=Fe(r),i=n.webId,e.next=11,fetch(i,{headers:{Accept:"application/json"}});case 11:if(!(c=e.sent).ok){e.next=17;break}return e.next=15,c.json();case 15:u=e.sent,d.checkUser(u)?(localStorage.setItem("token",r),t.has("new")&&"true"===t.get("new")?(l("auth.message.new_user_created","info"),a.push("/"+s+"/"+encodeURIComponent(u.url||i)+"/edit")):(l("auth.message.user_connected","info"),a.push("/"))):(l("auth.message.user_not_allowed_to_login","error"),a.replace("/login"));case 17:t.has("logout")&&(localStorage.removeItem("token"),l("auth.message.user_disconnected","info"),a.push("/"));case 18:case"end":return e.stop()}}),e)})))()}),[o.search]),t.createElement(we,{theme:Ee(r)},t.createElement("div",{className:u.main},t.createElement(ne,{className:u.card},t.createElement("div",{className:u.lockIconAvatar},t.createElement(q,{className:u.lockIcon},t.createElement(je,null))),c&&t.createElement(ae,{variant:"body2",className:u.text},c),i&&i.map((function(e,r){var n=new URL(e);return n.searchParams.set("mode","login"),n.searchParams.set("redirect",window.location.href),t.createElement(oe,{key:r},t.createElement(ie,{fullWidth:!0,variant:"outlined",type:"submit",onClick:function(){return window.location.href=n.toString()}},n.host))})))),t.createElement(C,null))};Lt.defaultProps={userResource:"Person"};function zt(){}function Wt(){}Wt.resetWarningCache=zt;var Dt=function(){function e(e,t,r,n,a,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Wt,resetWarningCache:zt};return r.PropTypes=r,r},Vt=$e((function(e){e.exports=Dt()})),Yt=$e((function(e){
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){var t={}.hasOwnProperty;function r(){for(var e=[],n=0;n<arguments.length;n++){var a=arguments[n];if(a){var o=typeof a;if("string"===o||"number"===o)e.push(a);else if(Array.isArray(a)){if(a.length){var i=r.apply(null,a);i&&e.push(i)}}else if("object"===o)if(a.toString===Object.prototype.toString)for(var s in a)t.call(a,s)&&a[s]&&e.push(s);else e.push(a.toString())}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):window.classNames=r}()})),Bt=function(){var e=p();return a((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.signup(t)}),[e])},Ft=["meta","input"],Mt=Y((function(e){return{form:{padding:"0 1em 1em 1em"},input:{marginTop:"1em"},button:{width:"100%"},icon:{marginRight:e.spacing(1)}}})),$t=function(t){var r=t.meta,n=r.touched,a=r.error,o=t.input,i=Ne(t,Ft);return e.createElement(B,Te({error:!(!n||!a),helperText:n&&a},o,i,{fullWidth:!0}))},qt=function(t){var r=t.redirectTo,n=t.delayBeforeRedirect,a=Ue(S(!1),2),o=a[0],i=a[1],c=Bt(),u=s(),l=E(),d=Mt(),m=ve(),p=new URLSearchParams(m.search);return e.createElement(xe,{onSubmit:function(e){i(!0),c(e).then((function(e){n?setTimeout((function(){window.location.reload(),window.location.href=r||"/",i(!1)}),n):(window.location.reload(),window.location.href=r||"/",i(!1)),l("auth.message.new_user_created","info")})).catch((function(e){i(!1),l("string"==typeof e?e:void 0!==e&&e.message?e.message:"ra.auth.sign_in_error","warning",{_:"string"==typeof e?e:e&&e.message?e.message:void 0})}))},validate:function(e){var t={email:void 0,password:void 0};return e.email||(t.email=u("ra.validation.required")),e.password||(t.password=u("ra.validation.required")),t},initialValues:{name:p.get("name"),email:p.get("email")},render:function(t){var r=t.handleSubmit;return e.createElement("form",{onSubmit:r,noValidate:!0},e.createElement("div",{className:d.form},e.createElement("div",{className:d.input},e.createElement(ke,{autoFocus:!0,id:"name",name:"name",component:$t,label:u("auth.input.name"),disabled:o})),e.createElement("div",{className:d.input},e.createElement(ke,{id:"username",name:"username",component:$t,label:u("auth.input.username"),disabled:o})),e.createElement("div",{className:d.input},e.createElement(ke,{id:"email",name:"email",component:$t,label:u("auth.input.email"),disabled:o||p.has("email")&&p.has("force-email")})),e.createElement("div",{className:d.input},e.createElement(ke,{id:"password",name:"password",component:$t,label:u("ra.auth.password"),type:"password",disabled:o}))),e.createElement(oe,null,e.createElement(ie,{variant:"contained",type:"submit",color:"primary",disabled:o,className:d.button},o&&e.createElement(se,{className:d.icon,size:18,thickness:2}),u("auth.action.signup"))))}})};qt.propTypes={redirectTo:Vt.string};var Ht=["theme","title","classes","className"],Gt=Y((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",height:"1px",alignItems:"center",justifyContent:"flex-start",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundImage:"radial-gradient(circle at 50% 14em, #313264 0%, #00023b 60%, #00023b 100%)"},card:{minWidth:300,marginTop:"6em"},avatar:{margin:"1em",display:"flex",justifyContent:"center"},icon:{backgroundColor:e.palette.secondary[500]},switch:{margin:"1em",display:"flex",justifyContent:"center"}}})),Jt=function(e){var r=e.theme;e.title,e.classes;var n=e.className,a=Ne(e,Ht),i=Gt(e),c=ve(),u=s(),l=o((function(){return ce(r)}),[r]),d=new URLSearchParams(c.search),m=d.has("signup"),p=d.get("redirect"),f=_(),h=f.identity;return f.loading?null:null!=h&&h.id?t.createElement(be,{to:p||"/"}):t.createElement(ue,{theme:l},t.createElement("div",Te({className:Yt(i.main,n)},a),t.createElement(ne,{className:i.card},t.createElement("div",{className:i.avatar},t.createElement(q,{className:i.icon},t.createElement(je,null))),m?t.createElement(qt,{redirectTo:p,delayBeforeRedirect:3e3}):t.createElement(A,{redirectTo:p}),t.createElement("div",{className:i.switch},m?t.createElement(ye,{to:"/login"},t.createElement(ae,{variant:"body2"},u("auth.action.login"))):t.createElement(ye,{to:"/login?signup=true"},t.createElement(ae,{variant:"body2"},u("auth.action.signup"))))),t.createElement(C,null)))};Jt.propTypes={children:Vt.node,classes:Vt.object,className:Vt.string,theme:Vt.object};var Kt=Y((function(e){return{root:{color:e.palette.text.secondary},active:{color:e.palette.text.primary},icon:{minWidth:e.spacing(5)}}})),Qt=i((function(e,r){var n=Kt(),a=R(),o=s();return t.createElement(Q,{onClick:function(){return a()},ref:r,className:n.root,activeClassName:n.active},t.createElement(X,{className:n.icon},t.createElement(Pe,null)),o("auth.action.logout"))})),Xt=["name","create"],Zt=function(e){var r=e.name,n=e.create,a=Ne(e,Xt),o=V(r),i=m(o).permissions;return t.createElement(I,Te({},a,{name:r,create:i&&i.some((function(e){return tt.includes(e["acl:mode"])}))?n:void 0}))},er=["logout"],tr=i((function(e,r){var n=e.onClick,a=e.label,o=e.webId;return t.createElement(N,{ref:r,to:"/Person/".concat(encodeURIComponent(o),"/show"),primaryText:a,leftIcon:t.createElement(Oe,null),onClick:n})})),rr=i((function(e,r){var n=e.onClick,a=e.label,o=e.webId;return t.createElement(N,{ref:r,to:"/Person/".concat(encodeURIComponent(o)),primaryText:a,leftIcon:t.createElement(me,null),onClick:n})})),nr=i((function(e,r){var n=e.onClick,a=e.label;return t.createElement(N,{ref:r,to:"/login",primaryText:a,onClick:n})})),ar=i((function(e,r){var n=e.onClick,a=e.label;return t.createElement(N,{ref:r,to:"/login?signup=true",primaryText:a,onClick:n})})),or=function(e){var r=e.logout,n=Ne(e,er),a=_().identity,o=s();return t.createElement(T,n,a&&""!==a.id?[t.createElement(tr,{webId:a.id,label:o("auth.action.view_my_profile"),key:"view"}),t.createElement(rr,{webId:a.id,label:o("auth.action.edit_my_profile"),key:"edit"}),t.cloneElement(r,{key:"logout"})]:[t.createElement(ar,{label:o("auth.action.signup"),key:"signup"}),t.createElement(nr,{label:o("auth.action.login"),key:"login"})])};var ir=function(){this.__data__=[],this.size=0};var sr=function(e,t){return e===t||e!=e&&t!=t};var cr=function(e,t){for(var r=e.length;r--;)if(sr(e[r][0],t))return r;return-1},ur=Array.prototype.splice;var lr=function(e){var t=this.__data__,r=cr(t,e);return!(r<0)&&(r==t.length-1?t.pop():ur.call(t,r,1),--this.size,!0)};var dr=function(e){var t=this.__data__,r=cr(t,e);return r<0?void 0:t[r][1]};var mr=function(e){return cr(this.__data__,e)>-1};var pr=function(e,t){var r=this.__data__,n=cr(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function fr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}fr.prototype.clear=ir,fr.prototype.delete=lr,fr.prototype.get=dr,fr.prototype.has=mr,fr.prototype.set=pr;var hr=fr;var gr=function(){this.__data__=new hr,this.size=0};var vr=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var br=function(e){return this.__data__.get(e)};var yr=function(e){return this.__data__.has(e)},wr="object"==typeof Me&&Me&&Me.Object===Object&&Me,_r="object"==typeof self&&self&&self.Object===Object&&self,Er=wr||_r||Function("return this")(),jr=Er.Symbol,xr=Object.prototype,kr=xr.hasOwnProperty,Pr=xr.toString,Or=jr?jr.toStringTag:void 0;var Cr=function(e){var t=kr.call(e,Or),r=e[Or];try{e[Or]=void 0;var n=!0}catch(e){}var a=Pr.call(e);return n&&(t?e[Or]=r:delete e[Or]),a},Sr=Object.prototype.toString;var Ar=function(e){return Sr.call(e)},Rr=jr?jr.toStringTag:void 0;var Ir=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Rr&&Rr in Object(e)?Cr(e):Ar(e)};var Tr=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var Nr,Ur=function(e){if(!Tr(e))return!1;var t=Ir(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Lr=Er["__core-js_shared__"],zr=(Nr=/[^.]+$/.exec(Lr&&Lr.keys&&Lr.keys.IE_PROTO||""))?"Symbol(src)_1."+Nr:"";var Wr=function(e){return!!zr&&zr in e},Dr=Function.prototype.toString;var Vr=function(e){if(null!=e){try{return Dr.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Yr=/^\[object .+?Constructor\]$/,Br=Function.prototype,Fr=Object.prototype,Mr=Br.toString,$r=Fr.hasOwnProperty,qr=RegExp("^"+Mr.call($r).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Hr=function(e){return!(!Tr(e)||Wr(e))&&(Ur(e)?qr:Yr).test(Vr(e))};var Gr=function(e,t){return null==e?void 0:e[t]};var Jr=function(e,t){var r=Gr(e,t);return Hr(r)?r:void 0},Kr=Jr(Er,"Map"),Qr=Jr(Object,"create");var Xr=function(){this.__data__=Qr?Qr(null):{},this.size=0};var Zr=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},en=Object.prototype.hasOwnProperty;var tn=function(e){var t=this.__data__;if(Qr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return en.call(t,e)?t[e]:void 0},rn=Object.prototype.hasOwnProperty;var nn=function(e){var t=this.__data__;return Qr?void 0!==t[e]:rn.call(t,e)};var an=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Qr&&void 0===t?"__lodash_hash_undefined__":t,this};function on(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}on.prototype.clear=Xr,on.prototype.delete=Zr,on.prototype.get=tn,on.prototype.has=nn,on.prototype.set=an;var sn=on;var cn=function(){this.size=0,this.__data__={hash:new sn,map:new(Kr||hr),string:new sn}};var un=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var ln=function(e,t){var r=e.__data__;return un(t)?r["string"==typeof t?"string":"hash"]:r.map};var dn=function(e){var t=ln(this,e).delete(e);return this.size-=t?1:0,t};var mn=function(e){return ln(this,e).get(e)};var pn=function(e){return ln(this,e).has(e)};var fn=function(e,t){var r=ln(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function hn(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}hn.prototype.clear=cn,hn.prototype.delete=dn,hn.prototype.get=mn,hn.prototype.has=pn,hn.prototype.set=fn;var gn=hn;var vn=function(e,t){var r=this.__data__;if(r instanceof hr){var n=r.__data__;if(!Kr||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new gn(n)}return r.set(e,t),this.size=r.size,this};function bn(e){var t=this.__data__=new hr(e);this.size=t.size}bn.prototype.clear=gr,bn.prototype.delete=vr,bn.prototype.get=br,bn.prototype.has=yr,bn.prototype.set=vn;var yn=bn;var wn=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var _n=function(e){return this.__data__.has(e)};function En(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new gn;++t<r;)this.add(e[t])}En.prototype.add=En.prototype.push=wn,En.prototype.has=_n;var jn=En;var xn=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var kn=function(e,t){return e.has(t)};var Pn=function(e,t,r,n,a,o){var i=1&r,s=e.length,c=t.length;if(s!=c&&!(i&&c>s))return!1;var u=o.get(e),l=o.get(t);if(u&&l)return u==t&&l==e;var d=-1,m=!0,p=2&r?new jn:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var f=e[d],h=t[d];if(n)var g=i?n(h,f,d,t,e,o):n(f,h,d,e,t,o);if(void 0!==g){if(g)continue;m=!1;break}if(p){if(!xn(t,(function(e,t){if(!kn(p,t)&&(f===e||a(f,e,r,n,o)))return p.push(t)}))){m=!1;break}}else if(f!==h&&!a(f,h,r,n,o)){m=!1;break}}return o.delete(e),o.delete(t),m},On=Er.Uint8Array;var Cn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var Sn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},An=jr?jr.prototype:void 0,Rn=An?An.valueOf:void 0;var In=function(e,t,r,n,a,o,i){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new On(e),new On(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return sr(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=Cn;case"[object Set]":var c=1&n;if(s||(s=Sn),e.size!=t.size&&!c)return!1;var u=i.get(e);if(u)return u==t;n|=2,i.set(e,t);var l=Pn(s(e),s(t),n,a,o,i);return i.delete(e),l;case"[object Symbol]":if(Rn)return Rn.call(e)==Rn.call(t)}return!1};var Tn=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e},Nn=Array.isArray;var Un=function(e,t,r){var n=t(e);return Nn(e)?n:Tn(n,r(e))};var Ln=function(e,t){for(var r=-1,n=null==e?0:e.length,a=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[a++]=i)}return o};var zn=function(){return[]},Wn=Object.prototype.propertyIsEnumerable,Dn=Object.getOwnPropertySymbols,Vn=Dn?function(e){return null==e?[]:(e=Object(e),Ln(Dn(e),(function(t){return Wn.call(e,t)})))}:zn;var Yn=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var Bn=function(e){return null!=e&&"object"==typeof e};var Fn=function(e){return Bn(e)&&"[object Arguments]"==Ir(e)},Mn=Object.prototype,$n=Mn.hasOwnProperty,qn=Mn.propertyIsEnumerable,Hn=Fn(function(){return arguments}())?Fn:function(e){return Bn(e)&&$n.call(e,"callee")&&!qn.call(e,"callee")};var Gn=function(){return!1},Jn=$e((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?Er.Buffer:void 0,o=(a?a.isBuffer:void 0)||Gn;e.exports=o})),Kn=/^(?:0|[1-9]\d*)$/;var Qn=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Kn.test(e))&&e>-1&&e%1==0&&e<t};var Xn=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Zn={};Zn["[object Float32Array]"]=Zn["[object Float64Array]"]=Zn["[object Int8Array]"]=Zn["[object Int16Array]"]=Zn["[object Int32Array]"]=Zn["[object Uint8Array]"]=Zn["[object Uint8ClampedArray]"]=Zn["[object Uint16Array]"]=Zn["[object Uint32Array]"]=!0,Zn["[object Arguments]"]=Zn["[object Array]"]=Zn["[object ArrayBuffer]"]=Zn["[object Boolean]"]=Zn["[object DataView]"]=Zn["[object Date]"]=Zn["[object Error]"]=Zn["[object Function]"]=Zn["[object Map]"]=Zn["[object Number]"]=Zn["[object Object]"]=Zn["[object RegExp]"]=Zn["[object Set]"]=Zn["[object String]"]=Zn["[object WeakMap]"]=!1;var ea=function(e){return Bn(e)&&Xn(e.length)&&!!Zn[Ir(e)]};var ta=function(e){return function(t){return e(t)}},ra=$e((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r&&wr.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=o})),na=ra&&ra.isTypedArray,aa=na?ta(na):ea,oa=Object.prototype.hasOwnProperty;var ia=function(e,t){var r=Nn(e),n=!r&&Hn(e),a=!r&&!n&&Jn(e),o=!r&&!n&&!a&&aa(e),i=r||n||a||o,s=i?Yn(e.length,String):[],c=s.length;for(var u in e)!t&&!oa.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Qn(u,c))||s.push(u);return s},sa=Object.prototype;var ca=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||sa)};var ua=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),la=Object.prototype.hasOwnProperty;var da=function(e){if(!ca(e))return ua(e);var t=[];for(var r in Object(e))la.call(e,r)&&"constructor"!=r&&t.push(r);return t};var ma=function(e){return null!=e&&Xn(e.length)&&!Ur(e)};var pa=function(e){return ma(e)?ia(e):da(e)};var fa=function(e){return Un(e,pa,Vn)},ha=Object.prototype.hasOwnProperty;var ga=function(e,t,r,n,a,o){var i=1&r,s=fa(e),c=s.length;if(c!=fa(t).length&&!i)return!1;for(var u=c;u--;){var l=s[u];if(!(i?l in t:ha.call(t,l)))return!1}var d=o.get(e),m=o.get(t);if(d&&m)return d==t&&m==e;var p=!0;o.set(e,t),o.set(t,e);for(var f=i;++u<c;){var h=e[l=s[u]],g=t[l];if(n)var v=i?n(g,h,l,t,e,o):n(h,g,l,e,t,o);if(!(void 0===v?h===g||a(h,g,r,n,o):v)){p=!1;break}f||(f="constructor"==l)}if(p&&!f){var b=e.constructor,y=t.constructor;b==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(p=!1)}return o.delete(e),o.delete(t),p},va=Jr(Er,"DataView"),ba=Jr(Er,"Promise"),ya=Jr(Er,"Set"),wa=Jr(Er,"WeakMap"),_a=Vr(va),Ea=Vr(Kr),ja=Vr(ba),xa=Vr(ya),ka=Vr(wa),Pa=Ir;(va&&"[object DataView]"!=Pa(new va(new ArrayBuffer(1)))||Kr&&"[object Map]"!=Pa(new Kr)||ba&&"[object Promise]"!=Pa(ba.resolve())||ya&&"[object Set]"!=Pa(new ya)||wa&&"[object WeakMap]"!=Pa(new wa))&&(Pa=function(e){var t=Ir(e),r="[object Object]"==t?e.constructor:void 0,n=r?Vr(r):"";if(n)switch(n){case _a:return"[object DataView]";case Ea:return"[object Map]";case ja:return"[object Promise]";case xa:return"[object Set]";case ka:return"[object WeakMap]"}return t});var Oa=Pa,Ca="[object Object]",Sa=Object.prototype.hasOwnProperty;var Aa=function(e,t,r,n,a,o){var i=Nn(e),s=Nn(t),c=i?"[object Array]":Oa(e),u=s?"[object Array]":Oa(t),l=(c="[object Arguments]"==c?Ca:c)==Ca,d=(u="[object Arguments]"==u?Ca:u)==Ca,m=c==u;if(m&&Jn(e)){if(!Jn(t))return!1;i=!0,l=!1}if(m&&!l)return o||(o=new yn),i||aa(e)?Pn(e,t,r,n,a,o):In(e,t,c,r,n,a,o);if(!(1&r)){var p=l&&Sa.call(e,"__wrapped__"),f=d&&Sa.call(t,"__wrapped__");if(p||f){var h=p?e.value():e,g=f?t.value():t;return o||(o=new yn),a(h,g,r,n,o)}}return!!m&&(o||(o=new yn),ga(e,t,r,n,a,o))};var Ra=function e(t,r,n,a,o){return t===r||(null==t||null==r||!Bn(t)&&!Bn(r)?t!=t&&r!=r:Aa(t,r,n,a,e,o))};var Ia=function(e,t){return Ra(e,t)},Ta={},Na={"{}":void 0},Ua=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ta,t=JSON.stringify(e),r=S({permissions:Na[t]}),o=Ue(r,2),i=o[0],s=o[1],c=U(),u=a((function(){return c(e).then((function(e){Ia(e,i.permissions)||(Na[t]=e,s({permissions:e}))})).catch((function(e){s({error:e})}))}),[t,e,c]);return n((function(){u()}),[t]),Se(Se({},i),{},{refetch:u})},La={auth:{dialog:{container_permissions:"Container permissions",resource_permissions:"Resource permissions"},action:{permissions:"Permissions",signup:"Signup",logout:"Logout",login:"Login",view_my_profile:"View my profile",edit_my_profile:"Edit my profile"},right:{resource:{read:"Read",append:"Append",write:"Write",control:"Control"},container:{read:"List",append:"Add",write:"Add",control:"Control"}},agent:{anonymous:"All users",authenticated:"Connected users"},input:{agent_select:"Add an user...",name:"Surname",username:"User ID",email:"Email address",username_or_email:"User ID or email address"},message:{resource_show_forbidden:"You are not allowed to view this resource",resource_edit_forbidden:"You are not allowed to edit this resource",resource_delete_forbidden:"You are not allowed to delete this resource",resource_control_forbidden:"You are not allowed to control this resource",container_create_forbidden:"You are not allowed to create new resource",container_list_forbidden:"You are not allowed to list these resources",user_not_allowed_to_login:"You are not allowed to login with this account",user_email_not_found:"No account found with this email address",user_email_exist:"An account already exist with this email address",username_exist:"An account already exist with this user ID",username_invalid:"This username is invalid. Only lowercase characters, numbers, dots and hyphens are authorized",new_user_created:"Your account has been successfully created",user_connected:"You are now connected",user_disconnected:"You are now disconnected",bad_request:"Bad request (Error message returned by the server: %{error})",account_settings_updated:"Your account settings have been successfully updated"}}},za={auth:{dialog:{container_permissions:"Permissions sur le container",resource_permissions:"Permissions sur la resource"},action:{permissions:"Permissions",signup:"S'inscrire",logout:"Se déconnecter",login:"Se connecter",view_my_profile:"Voir mon profil",edit_my_profile:"Éditer mon profil"},right:{resource:{read:"Lire",append:"Enrichir",write:"Modifier",control:"Administrer"},container:{read:"Lister",append:"Ajouter",write:"Ajouter",control:"Administrer"}},agent:{anonymous:"Tous les utilisateurs",authenticated:"Utilisateurs connectés"},input:{agent_select:"Ajouter un utilisateur...",name:"Prénom",username:"Identifiant unique",email:"Adresse e-mail",username_or_email:"Identifiant ou adresse e-mail"},message:{resource_show_forbidden:"Vous n'avez pas la permission de voir cette ressource",resource_edit_forbidden:"Vous n'avez pas la permission d'éditer cette ressource",resource_delete_forbidden:"Vous n'avez pas la permission d'effacer cette ressource",resource_control_forbidden:"Vous n'avez pas la permission d'administrer cette ressource",container_create_forbidden:"Vous n'avez pas la permission de créer des ressources",container_list_forbidden:"Vous n'avez pas la permission de voir ces ressources",user_not_allowed_to_login:"Vous n'avez pas le droit de vous connecter avec ce compte",user_email_not_found:"Aucun compte trouvé avec cette adresse mail",user_email_exist:"Un compte existe déjà avec cette adresse mail",username_exist:"Un compte existe déjà avec cet identifiant",username_invalid:"Cet identifiant n'est pas valide. Seuls les lettres minuscules, les chiffres, les points et les tirets sont autorisés",new_user_created:"Votre compte a été créé avec succès",user_connected:"Vous êtes maintenant connecté",user_disconnected:"Vous êtes maintenant déconnecté",bad_request:"Requête erronée (Message d'erreur renvoyé par le serveur: %{error})",account_settings_updated:"Les paramètres de votre compte ont été mis à jour avec succès"}}};export{Et as DeleteButtonWithPermissions,_t as EditActions,xt as EditToolbarWithPermissions,Ot as EditWithPermissions,St as ListWithPermissions,Jt as LocalLoginPage,Nt as LoginPage,Qt as LogoutButton,yt as PermissionsButton,Lt as PodLoginPage,Zt as ResourceWithPermissions,Rt as ShowActions,It as ShowWithPermissions,Nt as SsoLoginPage,or as UserMenu,Ze as authProvider,La as englishMessages,za as frenchMessages,gt as useAgents,kt as useCheckAuthenticated,Pt as useCheckPermissions,Ua as usePermissionsWithRefetch,Bt as useSignup};
//# sourceMappingURL=index.es.js.map
