import e,{useEffect as t,createElement as r,cloneElement as n,Children as a,useState as o}from"react";import{getResources as i,Notification as l,TopToolbar as c,ListButton as s,Create as u,ShowButton as m,Edit as d,CreateButton as p,ExportButton as f,RefreshButton as h,List as b,Pagination as g,SimpleList as E,useTranslate as v,getFieldLabelTranslationArgs as y,useListContext as P,linkToRecord as w,ImageField as x,EditButton as k,Show as L,sanitizeListRestProps as S,Link as N,useCreate as C,useNotify as I,ReferenceInput as T,Button as O,FormWithRedirect as B,TextInput as R,required as j,SaveButton as A}from"react-admin";import{makeStyles as F,useMediaQuery as W,Tabs as U,Tab as M,Box as V,Container as G,Grid as _,Typography as z,ThemeProvider as H,createMuiTheme as D,CircularProgress as $,LinearProgress as q,Dialog as J,DialogTitle as K,DialogContent as Q,DialogActions as X}from"@material-ui/core";import{Link as Y,useLocation as Z}from"react-router-dom";import{useForm as ee}from"react-final-form";import{useSelector as te,shallowEqual as re}from"react-redux";import{useHistory as ne,useLocation as ae}from"react-router";import{createMuiTheme as oe,ThemeProvider as ie,makeStyles as le}from"@material-ui/core/styles";import ce from"react-markdown";import se from"classnames";import ue from"@material-ui/icons/Add";import me from"@material-ui/icons/Cancel";function de(e,t,r,n,a,o,i){try{var l=e[o](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,a)}function pe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fe(){return(fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function he(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function be(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}(e,t)||Ee(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e){return function(e){if(Array.isArray(e))return ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ee(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(e,t){if(e){if("string"==typeof e)return ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ve(e,t):void 0}}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ye=F((function(e){return{tab:{minWidth:55},flexContainer:{display:"block"}}})),Pe=function(){var t=ne(),r=ye(),n=ae().pathname.match(/^\/([^/]+)/),a=n?n[1]:null,o=te(i,re),l=W((function(e){return e.breakpoints.down("xs")}));return e.createElement(U,{value:a,onChange:function(e,r){return t.push("/"+r)},indicatorColor:"primary",textColor:"black",classes:{flexContainer:r.flexContainer}},o.filter((function(e){return e.hasList})).map((function(t){return e.createElement(M,{key:t.name,icon:e.createElement(t.icon),label:l?void 0:t.options.label,value:t.name,className:r.tab})})))},we=F((function(e){return{header:{position:"relative",height:80},logo:pe({height:80,width:80},e.breakpoints.down("xs"),{position:"relative",top:0,width:65,height:65}),title:{position:"absolute",top:100,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}})),xe=function(t){t.userMenu,t.logout;var r=we();return e.createElement(V,{bgcolor:"primary.main"},e.createElement(G,{maxWidth:"lg",className:r.header},e.createElement(_,{container:!0},e.createElement(_,{item:!0,xs:12,sm:3},e.createElement(Y,{to:"/"},e.createElement("img",{src:process.env.PUBLIC_URL+"/logo192.png",alt:"SemApps",className:r.logo}))),e.createElement(_,{item:!0,sm:9,align:"right"},e.createElement(V,{p:1,align:"right"},e.createElement(Pe,null)))),e.createElement(z,{variant:"h4",color:"primary",className:r.title,id:"react-admin-title",component:"h1"})))},ke=function(){var e=Z().pathname;return t((function(){window.scrollTo(0,0)}),[e]),null},Le=function(t){var r=t.appBar,n=t.logout,a=t.theme,o=t.children,i=W(a.breakpoints.down("xs"));return e.createElement(H,{theme:a},e.createElement(ke,null),e.cloneElement(r,{logout:n}),e.createElement(G,{maxWidth:"lg",disableGutters:i},e.createElement(V,{mb:{xs:0,sm:5}},o)),e.createElement(l,null))};Le.defaultProps={appBar:e.createElement(xe,null)};var Se=D(),Ne=D({palette:{primary:{main:"#28ccfb"},secondary:{main:"#bcef5b"},grey:{main:"#e0e0e0"}},typography:{details:{fontSize:8}},overrides:{RaChipField:{chip:{marginLeft:0,marginTop:0,marginRight:8,marginBottom:8}},RaShow:{card:pe({padding:25},Se.breakpoints.down("xs"),{padding:15})},RaList:{content:pe({padding:25},Se.breakpoints.down("xs"),{padding:15})},RaListToolbar:{toolbar:pe({},Se.breakpoints.down("xs"),{height:0,minHeight:0})},RaSingleFieldList:{root:{marginTop:0,marginBottom:0}},MuiTab:{labelIcon:{paddingTop:0}}}}),Ce=function(t){var r=t.basePath,n=t.className,a=t.data,o=t.hasList,i=he(t,["basePath","className","data","hasList"]);return e.createElement(c,fe({className:n},i),o&&e.createElement(s,{basePath:r,record:a}))},Ie=function(t){return e.createElement(u,fe({actions:e.createElement(Ce,null),redirect:"show"},t))},Te=function(t){var r=t.basePath,n=t.className,a=t.data,o=t.hasList,i=t.hasShow,l=he(t,["basePath","className","data","hasList","hasShow"]);return e.createElement(c,fe({className:n},l),o&&e.createElement(s,{basePath:r,record:a}),i&&e.createElement(m,{basePath:r,record:a}))},Oe=function(t){return e.createElement(d,fe({actions:e.createElement(Te,null)},t))},Be=function(t){var r=t.bulkActions,n=t.basePath,a=t.currentSort,o=t.displayedFilters,l=t.exporter,s=t.filters,u=t.filterValues,m=t.onUnselectItems,d=t.resource,b=t.selectedIds,g=t.showFilter,E=t.total,v=W((function(e){return e.breakpoints.down("xs")})),y=te(i,re).filter((function(e){return e.name==d}))[0];return e.createElement(c,null,r&&e.cloneElement(r,{basePath:n,filterValues:u,resource:d,selectedIds:b,onUnselectItems:m}),s&&e.cloneElement(s,{resource:d,showFilter:g,displayedFilters:o,filterValues:u,context:"button"}),y.hasCreate&&e.createElement(p,{basePath:n}),!v&&e.createElement(f,{disabled:0===E,resource:d,sort:a,filter:u,exporter:l}),!v&&e.createElement(h,null))},Re=function(t){return e.createElement(g,fe({rowsPerPageOptions:[25,50,100]},t))},je=F((function(){return{content:{padding:20,paddingTop:15}}})),Ae=function(t){var r=t.children,n=he(t,["children"]),a=je();return e.createElement(b,fe({actions:e.createElement(Be,null),sort:{field:"pair:label",order:"DESC"},pagination:e.createElement(Re,null),perPage:50,classes:{content:a.content}},n),e.createElement(e.Fragment,null,r))},Fe=oe({overrides:{MuiListItem:{root:{padding:15,paddingBottom:15,paddingTop:15,marginBottom:10,borderStyle:"solid",borderColor:"#e0e0e0",borderWidth:1}}}}),We=function(t){return e.createElement(ie,{theme:Fe},e.createElement(E,t))},Ue=F((function(){return{rightLabel:{color:"grey",textAlign:"right",borderBottom:"1px dashed #c0c0c0",paddingBottom:10,marginBottom:10}}})),Me=function(t){var r=t.label,n=t.children,a=t.record,o=t.resource,i=t.source,l=t.basePath,c=Ue(),s=v();return a[i]?e.createElement(V,{mb:4},e.createElement(V,{className:c.rightLabel},s.apply(void 0,ge(y({label:r,resource:o,source:i})))),e.createElement(V,{m:0},e.cloneElement(n,{record:a,resource:o,basePath:l}))):null},Ve=function(t){var r=t.basePath,n=t.children,a=t.record,o=t.resource,i=t.showLabel,l=he(t,["basePath","children","record","resource","showLabel"]);return e.createElement(_,fe({item:!0},l),e.Children.map(n,(function(t){return t&&e.isValidElement(t)?e.createElement("div",{key:t.props.source},t.props.addLabel&&i?e.createElement(Me,{record:a,resource:o,basePath:r,label:t.props.label,source:t.props.source,disabled:!1},t):"string"==typeof t.type?t:e.cloneElement(t,{record:a,resource:o,basePath:r})):null})))},Ge=F((function(){return{root:{flexGrow:1}}})),_e=function(t){var r=t.basePath,n=t.children,a=t.record,o=t.resource,i=Ge();return e.createElement("div",{className:i.root},e.createElement(_,{container:!0,spacing:5},e.Children.map(n,(function(t){return t&&e.isValidElement(t)?e.cloneElement(t,{resource:o,record:a,basePath:r}):null}))))},ze=function(e){return e.stopPropagation()},He=function(){},De=function(e){var t=e.children,o=e.xs,i=e.linkType,l=P(),c=l.ids,s=l.data,u=l.basePath;return r(_,{container:!0,spacing:3},c.map((function(e){return r(_,{item:!0,xs:o,key:e},r(Y,{to:w(u,e,i),onClick:ze},n(a.only(t),{record:s[e],basePath:u,onClick:He})))})))};De.defaultProps={xs:6,linkType:"edit"};var $e=F((function(){return{line:{borderBottom:"1px solid #e0e0e0",marginTop:-6,marginBottom:7}}})),qe=function(t){var r=t.basePath,n=t.children,a=t.record,o=t.resource,i=$e(),l=v();return e.createElement(V,null,e.Children.map(n,(function(t){return t&&a[t.props.source]&&e.isValidElement(t)?e.createElement("div",{key:t.props.source},t.props.addLabel?e.createElement(_,{container:!0,spacing:3,className:i.line},e.createElement(_,{item:!0,xs:3},e.createElement(z,{color:"textSecondary",align:"right",variant:"body2"},l.apply(void 0,ge(y({label:t.props.label,resource:o,source:t.props.source}))))),e.createElement(_,{item:!0,xs:9},e.createElement(z,{variant:"body2"},e.cloneElement(t,{record:a,resource:o,basePath:r})))):"string"==typeof t.type?t:e.cloneElement(t,{record:a,resource:o,basePath:r})):null})))},Je=F((function(){return{loader:{width:"100%",backgroundColor:"#e0e0e0",paddingTop:100,paddingBottom:100},image:{width:"100%",maxHeight:"none"}}})),Ke=function(t){var r=t.record,n=t.source,a=t.defaultImage,o=he(t,["record","source","defaultImage"]),i=Je();if(r[n]){if(r[n].rawFile instanceof File)return e.createElement(V,{align:"center",className:i.loader},e.createElement($,null))}else r[n]=a;return e.createElement(x,fe({record:r,source:n,classes:{image:i.image}},o))},Qe=F((function(){return{root:{flexGrow:1}}})),Xe=function(t){var r=t.basePath,n=t.children,a=t.record,o=t.resource,i=t.image,l=t.defaultImage,c=Qe();return e.createElement("div",{className:c.root},e.createElement(z,{variant:"h3",color:"primary",component:"h1",id:"react-admin-title"}),e.createElement(_,{container:!0,spacing:5},e.createElement(_,{item:!0,xs:12,sm:5},e.createElement(Ke,{record:a,source:i,defaultImage:l})),e.createElement(_,{item:!0,xs:12,sm:7},e.createElement(qe,{record:a,resource:o,basePath:r},n))))};Xe.defaultProps={defaultImage:process.env.PUBLIC_URL+"/logo192.png"};var Ye=function(t){var r=t.basePath,n=t.className,a=t.data,o=t.hasList,i=t.hasEdit,l=he(t,["basePath","className","data","hasList","hasEdit"]);return e.createElement(c,fe({className:n},l),o&&e.createElement(s,{basePath:r,record:a}),i&&e.createElement(k,{basePath:r,record:a}))},Ze=function(t){return e.createElement(L,fe({actions:e.createElement(Ye,null)},t))},et=F((function(){return{parent:{position:"relative"},image:{width:"100%",borderRadius:"50%"},child:{position:"absolute",bottom:0,left:0,right:0,paddingTop:2,paddingBottom:2,paddingLeft:6,paddingRight:6},caption:{color:"black",fontSize:13}}})),tt=function(t){var r=t.record,n=et(),a=r?r["pair:firstName"]+" "+r["pair:lastName"]:"";return e.createElement(V,{className:n.parent},e.createElement("img",{src:r&&r.image||process.env.PUBLIC_URL+"/unknown-user.png",className:n.image,alt:a}),e.createElement(V,{bgcolor:"secondary.main",className:n.child,borderRadius:7},e.createElement(z,{align:"center",className:n.caption,noWrap:!0},a)))},rt=function(t){var r=t.source,n=t.record;return n&&n[r]?e.createElement(ce,{source:n[r]}):null},nt=le((function(e){return{root:{display:"flex",flexWrap:"wrap"},link:{}}})),at=function(e){return e.stopPropagation()},ot=function(){},it=function(e){e.classes;var t=e.className,o=e.children,i=e.linkType,l=void 0===i?"edit":i,c=e.separator,s=void 0===c?",":c,u=he(e,["classes","className","children","linkType","separator"]),m=P(e),d=m.ids,p=m.data,f=m.loaded,h=m.resource,b=m.basePath,g=nt(e);return!1===f?r(q,null):r("div",fe({className:se(g.root,t)},S(u)),d.map((function(e,t){var i=!!l&&w(b,e,l);return i?r("span",{key:e},r(N,{classes:g.link,to:i,onClick:at},n(a.only(o),{record:p[e],resource:h,basePath:b,onClick:ot})),t<d.length-1&&s+"Â "):n(a.only(o),{key:e,record:p[e],resource:h,basePath:b})})))},lt=F({root:{display:"flex",alignItems:"center"}}),ct=function(t){var r=t.label,n=t.reference,a=t.source,i=t.children,l=lt(),c=be(o(!1),2),s=c[0],u=c[1],m=be(C(n),2),d=m[0],p=m[1].loading,f=v(),h=I(),b=ee(),g=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d({payload:{data:t}},{onSuccess:function(e){var t=e.data;u(!1),b.change(a,t["@id"])},onFailure:function(e){var t=e.error;h(t.message,"error")}});case 1:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){de(o,n,a,i,l,"next",e)}function l(e){de(o,n,a,i,l,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();return e.createElement("div",{className:l.root},e.createElement(T,{label:r,reference:n,source:a},i),e.createElement(O,{onClick:function(){return u(!0)},label:"ra.action.create"},e.createElement(ue,null)),e.createElement(J,{fullWidth:!0,open:s,onClose:function(){return u(!1)}},e.createElement(K,null,f("ra.action.create")),e.createElement(B,{resource:n,save:g,render:function(t){var r=t.handleSubmitWithRedirect,n=t.pristine,a=t.saving;return e.createElement(e.Fragment,null,e.createElement(Q,null,e.createElement(R,{label:"Titre",source:"pair:label",validate:j(),fullWidth:!0})),e.createElement(X,null,e.createElement(O,{label:"ra.action.cancel",onClick:function(){return u(!1)},disabled:p},e.createElement(me,null)),e.createElement(A,{handleSubmitWithRedirect:r,pristine:n,saving:a,disabled:p})))}})))};export{xe as AppBar,Ve as Column,_e as ColumnShowLayout,Ie as Create,Ce as CreateActions,Oe as Edit,Te as EditActions,De as GridList,Xe as Hero,Le as Layout,Ae as List,rt as MarkdownField,ct as ReferenceQuickCreateInput,Pe as ResourceTabs,it as SeparatedListField,Ze as Show,Ye as ShowActions,We as SimpleList,tt as UserIcon,Ne as theme};
